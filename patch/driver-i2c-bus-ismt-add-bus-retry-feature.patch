From dff2b47208ca99a4786f8be9872a45ce72d8f855 Mon Sep 17 00:00:00 2001
From: Sergey Popovich <sergey.popovich@ordnance.co>
Date: Wed, 14 Mar 2018 08:58:28 +0200
Subject: i2c: ismt: add i2c bus retry feature

Signed-off-by: Sergey Popovich <sergey.popovich@ordnance.co>
---
 drivers/i2c/busses/i2c-ismt.c | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/drivers/i2c/busses/i2c-ismt.c b/drivers/i2c/busses/i2c-ismt.c
index 193dfb3..26caf55 100644
--- a/drivers/i2c/busses/i2c-ismt.c
+++ b/drivers/i2c/busses/i2c-ismt.c
@@ -616,6 +616,12 @@ out:
 	priv->head++;
 	priv->head %= ISMT_DESC_ENTRIES;
 
+	/* Foxconn: add i2c bus retry feature */
+	if (ret) {
+		dev_dbg(dev, "Retry i2c-ismt access\n");
+		return -EAGAIN;
+	}
+
 	return ret;
 }
 
-- 
2.7.4

